services:

#  zookeeper:
#    image: bitnami/zookeeper:3.8
#    environment:
#      - ALLOW_ANONYMOUS_LOGIN=yes
##    ports:
##      - 2181:2181
#    volumes:
#      - zookeeper_data:/bitnami
#
#  broker-0:  # shard 0
#    image: bitnami/kafka:3.1
#    environment:
#      - KAFKA_BROKER_ID=0
#      - KAFKA_CFG_LISTENERS=PLAINTEXT://:9092
#      - KAFKA_CFG_ADVERTISED_LISTENERS=PLAINTEXT://127.0.0.1:9092
#      - KAFKA_CFG_ZOOKEEPER_CONNECT=zookeeper:2181
#      - ALLOW_PLAINTEXT_LISTENER=yes
##    ports:
##      - 9092:9092
#    volumes:
#      - kafka_data:/bitnami
#    depends_on:
#      - zookeeper

#  broker-1:  # shard 1

#  request-receiver-0:
#    build:
#      context: ./request-receiver
#      dockerfile: Dockerfile
#    environment:
#      - FLASK_ENV=development
#      - FLASK_APP=main
#      - TOPIC=requests
#      - CLIENT_ID=request-receiver
#      - BROKER_HOST=broker-0
#      - BROKER_PORT=9092
#    ports:
#      - 8080:5000

  status-receiver-0:
    build:
      context: ./status-receiver
      dockerfile: Dockerfile
    environment:
      - FLASK_ENV=development
      - FLASK_APP=main
      - TOPIC=status-changes
      - CLIENT_ID=status-receiver
      - BROKER_HOST=broker-0
      - BROKER_PORT=9092
    ports:
      - 8081:5000
#
#  assigner-0:
#    build:
#      context: ./assigner
#      dockerfile: Dockerfile
#      environment:
#        - TOPICs=assignments,status-changes
#        - GROUP_ID=assigner
#    depends_on:
#      - redis
#
#  redis:
#    image: redis:6.2
#
#  notifier:
#    build:
#      context: ./notifier
#      dockerfile: Dockerfile
#      environment:
#        - TOPICs=assignments
#        - GROUP_ID=notifier

#volumes:
#  zookeeper_data:
#    driver: local
#  kafka_data:
#    driver: local
